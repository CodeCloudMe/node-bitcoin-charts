<html>


	<head>
		<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
		<script src="http://code.highcharts.com/highcharts.js"></script>
		<script src="http://code.highcharts.com/modules/exporting.js"></script>


		<script>


		$(document).ready(function(){

			
			getData();
			//makeChart();
		})


		




		function getData(){

			$.ajax({

				url:'http://bitstamp-searchgag.rhcloud.com/getAllData',

				complete:function(transport){

					var resp = transport.responseText;

					info = $.parseJSON(resp);

					//empty array we are going to make into something we can send to highcharts

					highChartData=[];

					for(i in info){

						var thisExchangeData = info[i];

						thisExchangesArray=[];
						for(j in thisExchangeData){

							var newInfo = [info[i]['timestamp'],info[i]['price'];
							thisExchangesArray.push(newInfo);

						}

						highChartData.push({'name': i, 'data':thisExchangesArray })
						//chartData[i]= [info[i]['timestamp'],info[i]['price'] ];

					}

					/*
					[{
			            name: 'Bitstamp',

			            data: data1

			        }]
					*/


					console.log(highChartData);

					makeChart(highChartData);



					

				}

			})
		}

		function makeChart(data1){
			$('#container').highcharts({
			        chart: {
			            type: 'spline'
			        },
			        title: {
			            text: 'Bitstamp prices'
			        },
			        subtitle: {
			            text: 'Source: Bitstamp'
			        },
			       
			        xAxis: {
			           type: 'datetime'
			        },
			        yAxis: {
			            title: {
			                text: '$ (USD)'
			            }
			           
			        },
			        tooltip: {
			            crosshairs: true,
			            shared: true
			        },
			        plotOptions: {
			            spline: {
			                marker: {
			                    radius: 4,
			                    lineColor: '#666666',
			                    lineWidth: 1
			                }
			            }
			        },
			        series: data1
			    });
		}

		</script>
	</head>



	<body>

		<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

	</body>

</html>